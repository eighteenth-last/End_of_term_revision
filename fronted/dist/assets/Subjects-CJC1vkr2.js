import{i as G,c as f,e as i,h as k,u as J,j as Q,r,a as W,s as X,o as Y,b as n,w as e,d as o,k as w,f as d,g as _,N as h,l as A,F as Z,m as ee,t as B,n as N,q as te}from"./index-CLO37vWr.js";import{A as ne}from"./AddOutline-DtchF70k.js";import{T as oe}from"./TrashOutline-D3PAmIE5.js";const le={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},se=k("circle",{cx:"256",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),ae=k("circle",{cx:"416",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),re=k("circle",{cx:"96",cy:"256",r:"32",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),ie=[se,ae,re],ue=G({name:"EllipsisHorizontalOutline",render:function(a,b){return i(),f("svg",le,ie)}}),ce={key:1,style:{display:"grid","grid-template-columns":"repeat(auto-fill, minmax(400px, 420px))",gap:"24px",padding:"8px","margin-top":"24px"}},_e={__name:"Subjects",setup(D){const a=J(),b=Q(),g=r(!1),v=r(!1),u=r(!1),O=W(),{userId:C}=X(O),y=r([]),S=r(null),c=r({name:""}),$={name:[{required:!0,message:"请输入科目名称",trigger:"blur"}]},j=l=>[{label:"删除",key:"delete",icon:()=>N(h,null,{default:()=>N(oe)})}],E=(l,t)=>{l==="delete"&&M(t)},x=async()=>{g.value=!0;try{y.value=await w.list(C.value)}catch(l){a.error(l.message||"加载科目列表失败")}finally{g.value=!1}},T=async()=>{var l;try{await((l=S.value)==null?void 0:l.validate()),v.value=!0,await w.create({name:c.value.name,user_id:C.value}),a.success("科目添加成功"),u.value=!1,c.value.name="",x()}catch(t){t.message&&a.error(t.message)}finally{v.value=!1}},M=l=>{b.warning({title:"确认删除",content:`确定要删除科目"${l.name}"吗？删除后该科目下的所有题目也将被删除！`,positiveText:"确定",negativeText:"取消",onPositiveClick:async()=>{try{await w.delete(l.id),a.success("科目删除成功"),x()}catch(t){a.error(t.message||"删除失败")}}})};return Y(()=>{x()}),(l,t)=>{const m=o("n-button"),p=o("n-space"),R=o("n-page-header"),U=o("n-empty"),z=o("n-text"),V=o("n-dropdown"),q=o("n-card"),F=o("n-spin"),H=o("n-input"),I=o("n-form-item"),K=o("n-form"),L=o("n-modal");return i(),f("div",null,[n(R,{title:"科目管理",subtitle:"管理你的学习科目"},{extra:e(()=>[n(p,null,{default:e(()=>[n(m,{type:"primary",onClick:t[0]||(t[0]=s=>u.value=!0)},{icon:e(()=>[n(_(h),null,{default:e(()=>[n(_(ne))]),_:1})]),default:e(()=>[t[4]||(t[4]=d(" 添加科目 ",-1))]),_:1})]),_:1})]),_:1}),n(F,{show:g.value,style:{"margin-top":"24px"}},{default:e(()=>[y.value.length===0?(i(),A(U,{key:0,description:"还没有科目，快来添加一个吧！",style:{"margin-top":"60px"}})):(i(),f("div",ce,[(i(!0),f(Z,null,ee(y.value,s=>(i(),A(q,{key:s.id,hoverable:"",style:{height:"180px",display:"flex","flex-direction":"column"}},{header:e(()=>[n(p,{align:"center",justify:"space-between",style:{width:"100%"}},{default:e(()=>[n(z,{strong:"",style:{"font-size":"18px"}},{default:e(()=>[d(B(s.name),1)]),_:2},1024)]),_:2},1024)]),"header-extra":e(()=>[n(V,{options:j(s),onSelect:P=>E(P,s)},{default:e(()=>[n(m,{text:"",circle:""},{icon:e(()=>[n(_(h),{size:"20"},{default:e(()=>[n(_(ue))]),_:1})]),_:1})]),_:1},8,["options","onSelect"])]),default:e(()=>[n(p,{vertical:"",style:{flex:"1","justify-content":"center"}},{default:e(()=>[n(z,{depth:"3",style:{"font-size":"14px"}},{default:e(()=>[d(" 创建时间："+B(s.created_at),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]))]),_:1},8,["show"]),n(L,{show:u.value,"onUpdate:show":t[3]||(t[3]=s=>u.value=s),preset:"dialog",title:"添加科目"},{action:e(()=>[n(p,null,{default:e(()=>[n(m,{onClick:t[2]||(t[2]=s=>u.value=!1)},{default:e(()=>[...t[5]||(t[5]=[d("取消",-1)])]),_:1}),n(m,{type:"primary",onClick:T,loading:v.value},{default:e(()=>[...t[6]||(t[6]=[d(" 确定 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:e(()=>[n(K,{ref_key:"formRef",ref:S,model:c.value,rules:$},{default:e(()=>[n(I,{label:"科目名称",path:"name"},{default:e(()=>[n(H,{value:c.value.name,"onUpdate:value":t[1]||(t[1]=s=>c.value.name=s),placeholder:"请输入科目名称，如：数学、英语",onKeyup:te(T,["enter"])},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])])}}};export{_e as default};
